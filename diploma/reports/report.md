## Отчет по дипломной работе на тему «Предсказание цен на поддержанные автомобили в США в соответствии с данными сайта craigslist.org»

### 1.	Введение

Craigslist.org - одна из крупнейших интернет-площадок электронных объявлений в мире, особенно пользующаяся большой популярностью в США. Подавляющую часть этого сайта занимают объявления о продаже поддержанных автомобилей.

Представленный набор данных обновляется каждый месяц и содержит исчерпывающую информацию об автомобилях, которую предоставляет сайт craigslist.org, включая сведения о марке и модели автомобиля, его состоянии, цене продажи, пробеге и т.д. Актуальная версия набора данных представлена от 09.2020.

В рамках выполнения дипломной работы необходимо решить задачу регрессии и построить соответствующую модель, предсказывающую цены на поддержанные автомобили. Для проверки качества регрессии использовать метрики RMSE и MAE.

### 2.	Описание проблемы и набор данных

Данная проблема открыта для решения на платформе Kaggle в качестве упражнения для начинающих специалистов в области Data Science. Она была выбрана в качестве темы дипломной работы для подтверждения квалификации в области машинного обучения и умения применения знаний, полученных в ходе обучения.

Набор данных представляет собой 24 признаковых переменных и 1 целевую переменную (конечная стоимость автомобиля), которую необходимо предсказать. Единицы измерения считаются известными и понятными по умолчанию. Список признаковых переменных приведен ниже:

* идентификатор;
* url;
* регион;
* url региона;
* год выпуска;
* производитель;
* модель;
* состояние автомобиля;
* количество цилиндров;
* тип топлива;
* пробег;
* тех.паспорт;
* тип коробки передач;
* VIN-номер;
* привод;
* размер;
* тип кузова;
* цвет;
* url изображения;
* описание;
* округ;
* штат;
* координаты широты;
* координаты долготы.

Всего в наборе 423857 экземпляров. Для построения модели и оценки результатов набор данных был предварительно почищен от выбросов и пропусков, а затем разделен на обучаемую и тестовую выборки. Тестовая выборка составляет 20% от полученного набора данных. В итоговом наборе данных 245795 экземпляров.

### 3.	Подготовка данных

Для выполнения поставленной задачи был проведен EDA: выявлены и удалены маловажные признаки и выбросы; построена корреляционная матрица для выявления зависимостей между признаками; построены графики распределения числовых переменных; построены диаграммы размаха некоторых категориальных переменных и их корреляция с ценой; построены круговые диаграммы для наблюдения относительных значений каждого признака; построен график важности признаков, по сути дублирующий результаты построенной корреляционной матрицы.

### 4.	Построение модели

Для построения модели и решения задачи регрессии были выбраны линейные алгоритмы Linear Regression и Elastic Net и нелинейный алгоритм Random Forest Regressor, т.к. они являются наиболее подходящими для решения подобного типа задач (в данных отсутствуют выбросы и зашумление, достаточно большое количество экземпляров, небольшое количество значимых переменных).

При построении нелинейной использовались стандартные параметры, за исключением случайного начального состояния.

При построении моделей, основанных на алгоритмах Elastic Net и Random Forest Regressor, были предприняты попытки поиска оптимальных параметров – максимальное количество итераций для Elastic Net и максимальная глубина дерева для Random Forest.

Также построена нелинейная модель, основанная на единственной признаковой переменной – пробеге. При ее построении использовались стандартные параметры.

### 5.	Результаты

#### 5.1.	Результаты построения моделей

Для оценки результатов модели были выбраны метрики RMSE и MAE – они наиболее эффективно позволяют оценивать результаты предсказаний в случае, когда значения целевой переменной принимают достаточно большие значения, а также явно реагируют на наличие выбросов и шумов.
Полученные значения метрики RMSE:

* RMSE evaluation for Linear Regression: 11107.8228
* RMSE evaluation for Elastic Net: 11762.8751
* RMSE evaluation for Random Forest: 7907.9832


Полученные значения метрики MAE:

* MAE evaluation for Linear Regression: 6576.0179
* MAE evaluation for Elastic Net: 7169.9293
* MAE evaluation for Random Forest: 3473.6408


На основе полученных результатов метрик RMSE и MAE можно сделать вывод, что наиболее эффективной является нелинейная модель, построенная с использованием алгоритма Random Forest Regressor.

#### 5.2.	Результаты поиска оптимальных параметров

Поиск оптимальных параметров осуществлялся с использованием алгоритма GridSearchCV. Количество стратегий разделения для кросс-валидации равно 10.

Для алгоритма Elastic Net осуществлялся поиск оптимального значения максимального количества итераций в диапазоне от 10 до 1000. В ходе поиска, на который было затрачено 5 мин 58 сек, оптимальным значением максимального количества итераций является значение 10, а полученное значение метрики RMSE равно 11664.3.

Для алгоритма Random Forest Regressor осуществлялся поиск оптимального значения минимальной глубины для дерева в диапазоне от 2 до 30. По графику зависимости значений метрики RMSE от глубины дерева, представленному в docx-версии отчета и jupyter-ноутбуке, можно сделать вывод, что результат обучения модели улучшается при увеличении глубины деревьев.

В ходе поиска, на который было затрачено 10 ч 1 мин 24 сек, оптимальным значением глубины дерева является значение 29, а полученное значение метрики RMSE равно 7879.3.

#### 5.3.	Результаты построения модели с единственным признаком

При оценке результатов построения модели с единственной признаковой переменной – пробегом – также использовались метрики RMSE и MAE. Полученные значения метрик:

* RMSE evaluation: 10530.4146
* MAE evaluation: 5761.3969

На основе полученных результатов можно сделать вывод, что данная модель имеет право на существование, но для достижения лучших результатов необходимо использовать большее количество признаков.

### 6.	Дальнейшие направления исследований

Несмотря на то, что выбранные метрики для оценки работы алгоритма показали хорошие результаты, думаю, что, изменяя параметры алгоритма (например, максимальную глубину дерева в совокупности с максимальным количеством листьев), результат может быть улучшен.
Соответственно дальнейшие исследования могут быть направлены на продолжение поиска оптимальных параметров (с использованием алгоритмов GridSearchCV или RandomSearchCV).

